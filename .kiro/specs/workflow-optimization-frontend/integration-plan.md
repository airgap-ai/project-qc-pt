# 工作流优化功能整合方案

## 概述

将独立的工作流优化页面功能整合到现有的项目详情和任务中心页面中，提供更流畅的用户体验。

## 整合映射

### 1. 项目详情页面整合

#### 1.1 文档管理模块
**位置**: `project-detail.html` - 文档清单区域增强

**整合内容**:
- 文档上传功能（拖拽/点击上传）
- 从生产管理系统同步按钮
- 文档状态实时显示
- 文件格式验证和大小限制提示

**实现方式**:
- 在现有"当前阶段必需文档清单"区域添加上传按钮
- 点击文档项展开详情，显示上传/同步选项
- 使用模态框处理文档上传流程

#### 1.2 结构化内容展示
**位置**: `project-detail.html` - 右侧信息面板

**整合内容**:
- 项目金额与付款信息
- 项目进度时间轴
- 交付成果按阶段分组
- 人员要求对比

**实现方式**:
- 扩展右侧"项目关键信息"卡片
- 添加可折叠的详细信息区块
- 使用标签页切换不同信息类别

#### 1.3 合规性检查
**位置**: `project-detail.html` - 新增"合规检查"标签页或区块

**整合内容**:
- 统计卡片（总问题数、高风险、中风险、低风险）
- 问题列表（红色高亮）
- 标记为已知和去校验操作

**实现方式**:
- 在文档清单下方添加"合规性检查"折叠区域
- 点击展开显示检查结果
- 提供快速操作按钮

#### 1.4 数据比对
**位置**: `project-detail.html` - 新增"数据验证"区块

**整合内容**:
- 四大比对模块（金额、进度、交付物、人员）
- 实时状态显示
- 差异标注

**实现方式**:
- 在项目信息区域添加"数据比对"按钮
- 点击打开模态框显示比对结果
- 使用标签页切换不同比对类型

#### 1.5 预警管理
**位置**: `project-detail.html` - 顶部预警横幅 + 右侧预警卡片

**整合内容**:
- 三级预警（提醒/即将延期/已延期）
- 颜色标识和筛选
- 多渠道通知设置

**实现方式**:
- 在页面顶部添加预警横幅（有预警时显示）
- 右侧添加"项目预警"卡片
- 点击查看详细预警列表

### 2. 任务中心整合

#### 2.1 人工校验优化
**位置**: `task-center.html` - 任务详情处理界面

**整合内容**:
- 字段点击高亮文档区域
- 自动标记"已人工校验"
- 修改历史记录追踪

**实现方式**:
- 点击任务项打开校验工作台模态框
- 集成 `hitl-workbench.html` 的核心功能
- 在模态框中显示文档和字段编辑界面

#### 2.2 语义比对
**位置**: `task-center.html` - 新增"字段映射"任务类型

**整合内容**:
- AI 相似度分析（80%阈值）
- 用户确认功能
- 映射关系管理
- 导出/导入映射表

**实现方式**:
- 在任务列表中添加"字段映射"任务类型
- 点击打开语义比对界面
- 提供批量确认和管理功能

## 实施步骤

### 阶段 1: 项目详情页面增强（优先级：高）

1. **文档管理增强**
   - 在文档清单项添加上传/同步按钮
   - 创建文档上传模态框
   - 集成文件验证和进度显示

2. **结构化内容展示**
   - 扩展右侧信息面板
   - 添加可折叠的详细信息区块
   - 实现数据展示组件

3. **合规性检查集成**
   - 在文档清单下方添加合规检查区域
   - 实现问题列表和操作按钮
   - 添加统计卡片

### 阶段 2: 数据验证功能（优先级：中）

1. **数据比对模块**
   - 创建数据比对模态框
   - 实现四大比对功能
   - 添加差异标注和状态显示

2. **预警管理**
   - 添加顶部预警横幅
   - 创建预警卡片组件
   - 实现预警筛选和通知设置

### 阶段 3: 任务中心增强（优先级：中）

1. **人工校验优化**
   - 集成校验工作台到任务详情
   - 实现字段高亮和文档联动
   - 添加修改历史追踪

2. **语义比对**
   - 添加字段映射任务类型
   - 实现语义比对界面
   - 提供映射管理功能

## 技术实现

### 组件复用策略

1. **从独立页面提取核心组件**
   - 文档上传组件
   - 数据比对组件
   - 语义匹配组件
   - 预警卡片组件

2. **创建可复用的模态框**
   - 文档上传模态框
   - 数据比对模态框
   - 校验工作台模态框
   - 语义比对模态框

3. **JavaScript 模块化**
   - 将 `interactions-workflow.js` 的功能拆分
   - 整合到 `interactions.js` 中
   - 按功能模块组织代码

### 数据流设计

```
项目详情页面
├── 文档管理
│   ├── 上传文档 → 触发解析
│   ├── 同步文档 → 更新状态
│   └── 查看文档 → 打开预览
├── 合规检查
│   ├── 自动检查 → 显示结果
│   ├── 标记已知 → 更新状态
│   └── 去校验 → 跳转任务中心
├── 数据比对
│   ├── 触发比对 → 显示差异
│   ├── 确认差异 → 更新记录
│   └── 导出报告 → 生成文件
└── 预警管理
    ├── 查看预警 → 显示列表
    ├── 处理预警 → 更新状态
    └── 设置通知 → 保存配置

任务中心
├── 人工校验
│   ├── 打开任务 → 显示工作台
│   ├── 编辑字段 → 高亮文档
│   ├── 保存修改 → 记录历史
│   └── 完成任务 → 更新状态
└── 字段映射
    ├── 查看建议 → 显示相似度
    ├── 确认映射 → 保存关系
    ├── 批量操作 → 更新多个
    └── 导出映射 → 生成文件
```

## UI/UX 改进

### 1. 减少页面跳转
- 使用模态框和折叠面板
- 在当前页面完成大部分操作
- 只在必要时跳转到新页面

### 2. 信息层次优化
- 重要信息优先显示
- 详细信息可折叠
- 使用标签页组织复杂内容

### 3. 操作流程简化
- 减少点击次数
- 提供快捷操作
- 智能默认值和建议

### 4. 视觉一致性
- 统一的颜色和图标
- 一致的交互模式
- 清晰的状态反馈

## 文件清理

整合完成后，以下独立页面可以删除或归档：
- `document-upload.html` → 整合到项目详情
- `structured-content.html` → 整合到项目详情
- `compliance-check.html` → 整合到项目详情
- `data-comparison.html` → 整合到项目详情
- `semantic-matching.html` → 整合到任务中心
- `alert-management.html` → 整合到项目详情和通知中心

保留 `interactions-workflow.js` 的核心逻辑，整合到 `interactions.js` 中。

## 验收标准

### 功能完整性
- [ ] 所有原有功能都已整合
- [ ] 数据流正确无误
- [ ] 交互逻辑完整

### 用户体验
- [ ] 操作流程顺畅
- [ ] 页面加载快速
- [ ] 响应式设计良好

### 代码质量
- [ ] 代码结构清晰
- [ ] 组件可复用
- [ ] 注释完整

### 兼容性
- [ ] 与现有功能无冲突
- [ ] 浏览器兼容性良好
- [ ] 移动端适配

## 时间估算

- 阶段 1: 2-3 天
- 阶段 2: 1-2 天
- 阶段 3: 1-2 天
- 测试和优化: 1 天

**总计**: 5-8 天

## 下一步行动

1. 审查并确认整合方案
2. 开始实施阶段 1
3. 逐步迭代和优化
4. 完成后清理独立页面
